<script>
    window.Caribouflex = window.Caribouflex || {};
    Caribouflex.Stepper = Caribouflex.Stepper || {};

    /**
     * @polymerMixin
     */
    Caribouflex.Stepper.StepPropertyMixin = function (superClass) {
        return class extends superClass {
            static get properties() {
                return {
                    save: {
                        type: Boolean,
                        value: false
                    },

                    editable: {
                        type: Boolean,
                        value: false
                    },

                    optional: {
                        type: Boolean,
                        value: false
                    },

                    __active: {
                        type: Boolean,
                        value: false
                    },

                    /**
                     * The continue button text value
                     */
                    continueLabel: {
                        type: String,
                        value: "Continue"
                    },

                    /**
                     * The finish button text value
                     */
                    finishLabel: {
                        type: String,
                        value: "Finish"
                    },

                    /**
                     * The update button text value
                     */
                    updateLabel: {
                        type: String,
                        value: "Update"
                    },

                    /**
                     * The skip button text value
                     */
                    skipLabel: {
                        type: String,
                        value: "Skip"
                    },

                    /**
                     * The skip button text value
                     */
                    skipButton: {
                        type: Boolean,
                        value: false
                    }
                }
            }

            _isPreviousSaved() {
                //check if previous element is saved
            }

            _isNextStepSaved() {

            }

            saveStep() {
                this.setAttribute("save", true);
            }

            openNextStep() {
                if (this.nextElementSibling !== undefined && this.nextElementSibling !== null && !this.nextElementSibling
                    .save) {
                    // We toggle the step. As parameter we set if it's the last step or not
                    // for the button.
                    this.nextElementSibling.toggleStep(this.parentElement.isLastStep());

                } else if (this.nextElementSibling !== undefined && this.nextElementSibling !== null)
                    this.nextElementSibling.openNextStep();
                else
                    this.dispatchEvent(new CustomEvent('last-step-closed', {
                        bubbles: true,
                        composed: true
                    }));
            }

            /**
             * This function is used to register an element to the parent.
             * @private
             */
            _register() {
                this.parentElement._registerStep(this);
            }

            _getOpenFirstStepOnStartup() {
                return this.parentElement.openFirstStepOnStartup;
            }
        }
    }
</script>