<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">
<link rel="import" href="custom-icons.html">
<link rel="import" href="caribou-step-action-buttons.html">
<link rel="import" href="caribou-stepper-context-mixin.html">

<dom-module id="caribou-step">
    <template>
        <style>
             :host {
                display: block;
            }

            span.subtitle {
                display: block;
                font-size: 0.8em;
                margin-top: 2px;
                max-width: 150px;
            }

            paper-button {
                display: flex;
                justify-content: flex-start;
            }

            div#labelBtn {
                align-self: center;
                padding: 0 16px;
                font-size: 14sp;
                color: #232323;
            }

            iron-icon#iconBtn {
                border-radius: 25px;
                background-color: #9e9e9e;
                color: #fff;
            }

            div.layout {
                border-left: 1px solid #bdbdbd;
                margin-left: 24px;
                padding: 10px 28px;
            }
        </style>

        <paper-button on-tap="toggle">
            <iron-icon id="iconBtn" icon="custom-icons:check"></iron-icon>
            <div id="labelBtn">{{label}}
                <span class="subtitle">{{label}}</span>
            </div>
        </paper-button>
        <div class="layout">
            <iron-collapse id="stepContent" opened="{{opened}}">
                <slot></slot>
                <caribou-step-action-buttons></caribou-step-action-buttons>
            </iron-collapse>
        </div>

    </template>

    <script>
        /**
         * `caribou-step`
         * one step 
         *
         * @memberof Caribouflex
         * @mixes Caribouflex.Stepper.ContextMixin
         * @demo demo/index.html
         */
        class CaribouStepElement extends Caribouflex.Stepper.ContextMixin(Polymer.Element) {
            static get is() {
                return 'caribou-step';
            }
            static get properties() {
                return {
                    label: {
                        type: String
                    },

                    isOpen: {
                        type: Boolean,
                        value: false
                    },

                    isSaved: {
                        type: Boolean,
                        value: false
                    },

                    isOptional: {
                        type: Boolean,
                        value: false
                    },

                    opened: {
                        type: Boolean,
                        reflectToAttribute: true
                    },
                };
            }

            constructor() {
                super();
                this.numberOfStep = this.numberOfStep + 1;
                Caribouflex.Stepper.ContextMixin.numberOfStep = Caribouflex.Stepper.ContextMixin.numberOfStep ===
                    undefined ? 1 : Caribouflex.Stepper.ContextMixin.numberOfStep + 1;
            }

            toggle() {
                this.$.stepContent.toggle();
            }

            ready() {
                super.ready();
                console.log(Caribouflex);
                console.log(this.numberOfStep);
            }
        }

        window.customElements.define(CaribouStepElement.is, CaribouStepElement);

        /**
         * @namespace Caribouflex
         */
        window.Caribouflex = window.Caribouflex || {};
        Caribouflex.CaribouStepElement = CaribouStepElement;
    </script>
</dom-module>